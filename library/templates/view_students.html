{% extends 'base.html' %}
{% load static %}
{% block title %}View Students{% endblock %}

{% block content %}
<div class="container my-4">
    <!-- Heading -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="fw-bold">ðŸŽ“ All Students</h2>
        <a href="/student_registration/" class="btn btn-primary">
            <i class="bi bi-person-plus"></i> Add New Student
        </a>
    </div>

    <!-- Search Bar -->
    <div class="input-group mb-4">
        <span class="input-group-text bg-dark text-white"><i class="bi bi-search"></i></span>
        <input type="text" id="studentSearch" class="form-control" placeholder="Search students by name, branch, or roll number...">
    </div>

    <!-- Students Grid -->
    <div class="row g-4" id="studentsGrid">
        {% if students %}
            {% for student in students %}
            <div class="col-md-4 student-card">
                <div class="card shadow-lg border-0 rounded-4 h-100">
                    <!-- Profile Picture -->
                    {% if student.image %}
                        <img src="{{ student.image.url }}" class="card-img-top" alt="Profile" height="220" style="object-fit: cover;">
                    {% else %}
                        <img src="https://cdn-icons-png.flaticon.com/512/149/149071.png" class="card-img-top" alt="Default Profile" height="220" style="object-fit: cover;">
                    {% endif %}

                    <!-- Student Info -->
                    <div class="card-body text-center">
                        <h5 class="fw-bold">{{ student.user.first_name }} {{ student.user.last_name }}</h5>
                        <p class="text-muted mb-1">
                            <i class="bi bi-mortarboard-fill"></i> {{ student.branch }} | {{ student.classroom }}
                        </p>
                        <p class="text-muted mb-1">
                            <i class="bi bi-card-list"></i> Roll: {{ student.roll_no }}
                        </p>
                        <p class="text-muted">
                            <i class="bi bi-envelope-fill"></i> {{ student.user.email }}
                        </p>
                    </div>

                    <!-- Actions -->
                    <div class="card-footer bg-light text-center">
                        <a href="/delete_student/{{ student.id }}/" 
                           class="btn btn-outline-danger btn-sm" 
                           onclick="return confirm('Are you sure you want to delete this student?');">
                            <i class="bi bi-trash"></i> Delete
                        </a>
                    </div>
                </div>
            </div>
            {% endfor %}
        {% else %}
            <div class="col-12 text-center text-muted">
                <h5>No students registered yet.</h5>
            </div>
        {% endif %}
    </div>
</div>

<!-- Live Search Script -->
<script>
    document.getElementById("studentSearch").addEventListener("keyup", function() {
        let value = this.value.toLowerCase();
        let cards = document.querySelectorAll(".student-card");

        cards.forEach(function(card) {
            card.style.display = card.textContent.toLowerCase().includes(value) ? "" : "none";
        });
    });
</script>
{% endblock %}
